# Базовый редактор

::alert
Данный гайд включает `rete-react-render-plugin`. В принципе, вы можете использовать его в любом приложении независимо от используемого фреймворка (React.js, Vue.js, Angular).

Если вы хотите использовать соответствующий рендер плагином в ваше **Angular** или **Vue** приложение, следуйте текущему гайду с оглядкой на гайды [для Angular](./angular) или [для Vue.js](./vue)
::

Для прохождения этого гайда вы можете создать приложение на **Codesandbox**, используя любой шаблон клиентских приложений, или инициализировать приложение локально.

#### Устанавливаем зависимости

```bash
npm i rete@next rete-area-plugin@next rete-connection-plugin@next rete-react-render-plugin@next rete-render-utils@next styled-components@next react@18 react-dom@18
```

#### Определяем тип узлов, инициализируем редактор

```ts
import { NodeEditor, GetSchemes, ClassicPreset } from "rete";

type Schemes = GetSchemes<
  ClassicPreset.Node,
  ClassicPreset.Connection<ClassicPreset.Node, ClassicPreset.Node>
>;

const editor = new NodeEditor<Schemes>();
```
где
- `Schemes` это тип, который в дальнейшем поможет вас с выводом типов при настройке плагинов. Как правило, в более сложных примерах вам потребуется расширить классы `ClassicPreset.Node` и `ClassicPreset.Connection`

#### Добавляем произвольный узел

Создаем узел с одним контролом и входным портом, и добавляем его в редактор. Имейте ввиду, что addNode это асинхронный метод

```ts
const socket = new ClassicPreset.Socket("socket");

const nodeA = new ClassicPreset.Node("A");
nodeA.addControl("a", new ClassicPreset.InputControl("text", {}));
nodeA.addOutput("a", new ClassicPreset.Output(socket));
await editor.addNode(nodeA);
```


#### Создаем область для визуализации с помощью React.js

Этот код должен быть до вызова `addNode`

```ts
import { createRoot } from "react-dom/client";
import { AreaPlugin } from "rete-area-plugin";
import { ReactRenderPlugin, Presets, ReactArea2D } from "rete-react-render-plugin";

type AreaExtra = ReactArea2D<Schemes>;

const area = new AreaPlugin<Schemes, AreaExtra>(container);
const render = new ReactRenderPlugin<Schemes>({ createRoot }); // createRoot required for React 18

render.addPreset(Presets.classic.setup({ area }));

editor.use(area);
area.use(render);
```
где
- `container` это HTMLElement, в который будет помещен редактор,
- `AreaExtra` это тип, позволяющий подмешивать кастомные виды отображаемых элементов, поскольку по умолчанию доступны только `node` и `connection`

#### Добавляем еще один узел

```ts
const nodeB = new ClassicPreset.Node("B");
nodeB.addControl("b", new ClassicPreset.InputControl("text", {}));
nodeB.addInput("b", new ClassicPreset.Input(socket));
await editor.addNode(nodeB);
```

Также соединяем эти узлы

```ts
await editor.addConnection(new ClassicPreset.Connection(nodeA, "a", nodeB, "b"));
```

#### Позиционируем узлы

На экране вы увидите два узла, которые накладываются друг на друга, но мы можем задать позицию второго узла

```ts
await area.translate(nodeB.id, { x: 270, y: 0 });
```

### Интерактивные соединения

```ts
import { ConnectionPlugin } from "rete-connection-plugin";

const connection = new ConnectionPlugin<Schemes, AreaExtra>();

area.use(connection);
```

#### Fit viewport

Чтобы сделать расположение вьюпорта так, чтобы в нем поместились все имеющиеся узлы, используйте расширение `zoomAt`

```ts
import { AreaExtensions } from "rete-area-plugin";

AreaExtensions.zoomAt(area, editor.getNodes());
```

#### Selectable nodes

Также в виде расширений вам доступны и другие функции, например возможность юзера выбирать узлы

```ts
AreaExtensions.selectableNodes(area, AreaExtensions.selector(), {
  accumulating: AreaExtensions.accumulateOnCtrl()
});
```

Как ясно из кода, пользователь может выбрать несколько узлов при нажатии на клавишу Ctrl. Выбранные узлы можно перемещать вместе

#### Порядок узлов

В некоторых случаях, особенно при наличии функции выделения узла, пользователь захочет видеть выбранные узлы так, чтобы их не перекрывали другие узлы. Для этого есть другое расширение, которое автоматически при выборе узла перемешает его на передний план

```ts
AreaExtensions.simpleNodesOrder(area);
```

Готовый результат вы можете найти на странице примера [Basic](/examples)
